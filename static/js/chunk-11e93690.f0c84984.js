(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11e93690"],{"0708":function(t,e,i){},"08f1":function(t,e,i){"use strict";i("8c6c")},2336:function(t,e,i){"use strict";i("0708")},"25eb":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return n}));var o=i("b775");function a(t){return Object(o["a"])({url:"/business/articleTag/list",method:"get",params:t})}function n(t){return Object(o["a"])({url:"/business/articleTag/"+t,method:"delete"})}},"39eb":function(t,e,i){},"6df5":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.editor?i("div",{class:{content:t.editable}},[t.editable?i("div",{staticClass:"bar"},[i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Bold",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("bold")},attrs:{disabled:!t.editor.can().chain().focus().toggleBold().run()},on:{click:function(e){t.editor.chain().focus().toggleBold().run()}}},[i("i",{staticClass:"ri-bold"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Italic",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("italic")},attrs:{disabled:!t.editor.can().chain().focus().toggleItalic().run()},on:{click:function(e){t.editor.chain().focus().toggleItalic().run()}}},[i("i",{staticClass:"ri-italic"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Strike",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("strike")},attrs:{disabled:!t.editor.can().chain().focus().toggleStrike().run()},on:{click:function(e){t.editor.chain().focus().toggleStrike().run()}}},[i("i",{staticClass:"ri-strikethrough"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Set Link",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("link")},on:{click:t.setLink}},[i("i",{staticClass:"ri-link"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Unset Link",placement:"top",effect:"light","open-delay":1e3}},[i("div",{attrs:{disabled:!t.editor.isActive("link")},on:{click:function(e){t.editor.chain().focus().unsetLink().run()}}},[i("i",{staticClass:"ri-link-unlink"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Code",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("code")},attrs:{disabled:!t.editor.can().chain().focus().toggleCode().run()},on:{click:function(e){t.editor.chain().focus().toggleCode().run()}}},[i("i",{staticClass:"ri-code-view"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Clear marks",placement:"top",effect:"light","open-delay":1e3}},[i("div",{on:{click:function(e){t.editor.chain().focus().unsetAllMarks().run()}}},[i("i",{staticClass:"ri-brush-3-line"})])]),i("span",{staticClass:"line"}),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Heading 1",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("heading",{level:1})},on:{click:function(e){t.editor.chain().focus().toggleHeading({level:1}).run()}}},[i("i",{staticClass:"ri-h-1"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Heading 2",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("heading",{level:2})},on:{click:function(e){t.editor.chain().focus().toggleHeading({level:2}).run()}}},[i("i",{staticClass:"ri-h-2"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Heading 3",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("heading",{level:3})},on:{click:function(e){t.editor.chain().focus().toggleHeading({level:3}).run()}}},[i("i",{staticClass:"ri-h-3"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Bullet list",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("bulletList")},on:{click:function(e){t.editor.chain().focus().toggleBulletList().run()}}},[i("i",{staticClass:"ri-list-unordered"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Ordered list",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("orderedList")},on:{click:function(e){t.editor.chain().focus().toggleOrderedList().run()}}},[i("i",{staticClass:"ri-list-ordered"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Code block",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("codeBlock")},on:{click:function(e){t.editor.chain().focus().toggleCodeBlock().run()}}},[i("i",{staticClass:"ri-code-box-line"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Blockquote",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive("blockquote")},on:{click:function(e){t.editor.chain().focus().toggleBlockquote().run()}}},[i("i",{staticClass:"ri-double-quotes-l"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Horizontal rule",placement:"top",effect:"light","open-delay":1e3}},[i("div",{on:{click:function(e){t.editor.chain().focus().setHorizontalRule().run()}}},[i("i",{staticClass:"ri-separator"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Hard break",placement:"top",effect:"light","open-delay":1e3}},[i("div",{on:{click:function(e){t.editor.chain().focus().setHardBreak().run()}}},[i("i",{staticClass:"ri-text-wrap"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Left",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive({textAlign:"left"})},on:{click:function(e){t.editor.chain().focus().setTextAlign("left").run()}}},[i("i",{staticClass:"ri-align-left"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Center",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive({textAlign:"center"})},on:{click:function(e){t.editor.chain().focus().setTextAlign("center").run()}}},[i("i",{staticClass:"ri-align-center"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Right",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive({textAlign:"right"})},on:{click:function(e){t.editor.chain().focus().setTextAlign("right").run()}}},[i("i",{staticClass:"ri-align-right"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Justify",placement:"top",effect:"light","open-delay":1e3}},[i("div",{class:{"is-active":t.editor.isActive({textAlign:"justify"})},on:{click:function(e){t.editor.chain().focus().setTextAlign("justify").run()}}},[i("i",{staticClass:"ri-align-justify"})])]),i("span",{staticClass:"line"}),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Undo",placement:"top",effect:"light","open-delay":1e3}},[i("div",{attrs:{disabled:!t.editor.can().chain().focus().undo().run()},on:{click:function(e){t.editor.chain().focus().undo().run()}}},[i("i",{staticClass:"ri-arrow-go-back-line"})])]),i("el-tooltip",{staticClass:"el-tooltip",attrs:{content:"Redo",placement:"top",effect:"light","open-delay":1e3}},[i("div",{attrs:{disabled:!t.editor.can().chain().focus().redo().run()},on:{click:function(e){t.editor.chain().focus().redo().run()}}},[i("i",{staticClass:"ri-arrow-go-forward-line"})])])],1):t._e(),i("editor-content",{staticClass:"input",attrs:{editor:t.editor}})],1):t._e()},a=[],n=i("d3a5"),l=i("71d8"),r=i("b268"),s=i("f2da"),c=i("d103"),u={components:{EditorContent:n["b"]},props:{value:{type:String,default:""},editable:{type:Boolean,default:!1}},data:function(){return{editor:null}},watch:{value:function(t){var e=this.editor.getHTML()===t;e||this.editor.commands.setContent(t,!1)}},mounted:function(){var t=this;this.editor=new n["a"]({editable:this.editable,content:this.value,extensions:[l["a"],r["a"],s["a"].configure({openOnClick:!1}),c["a"].configure({types:["heading","paragraph"]})],onUpdate:function(){t.$emit("input",t.editor.getHTML())}})},methods:{setLink:function(){var t=this.editor.getAttributes("link").href,e=window.prompt("URL",t);null!==e&&(""!==e?this.editor.chain().focus().extendMarkRange("link").setLink({href:e}).run():this.editor.chain().focus().extendMarkRange("link").unsetLink().run())}},beforeDestroy:function(){this.editor.destroy()}},d=u,f=(i("bd44"),i("2336"),i("2877")),p=Object(f["a"])(d,o,a,!1,null,"53c7d3a4",null);e["a"]=p.exports},"8bc5":function(t,e,i){"use strict";i.d(e,"d",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return l})),i.d(e,"e",(function(){return r})),i.d(e,"b",(function(){return s}));var o=i("b775");function a(t){return Object(o["a"])({url:"/business/category/list",method:"get",params:t})}function n(t){return Object(o["a"])({url:"/business/category/"+t,method:"get"})}function l(t){return Object(o["a"])({url:"/business/category",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/business/category",method:"put",data:t})}function s(t){return Object(o["a"])({url:"/business/category/"+t,method:"delete"})}},"8c6c":function(t,e,i){},a1fc:function(t,e,i){"use strict";i.d(e,"e",(function(){return a})),i.d(e,"f",(function(){return n})),i.d(e,"b",(function(){return l})),i.d(e,"g",(function(){return r})),i.d(e,"d",(function(){return s})),i.d(e,"a",(function(){return c})),i.d(e,"h",(function(){return u})),i.d(e,"c",(function(){return d}));var o=i("b775");function a(t){return Object(o["a"])({url:"/business/article/list",method:"get",params:t})}function n(t){return Object(o["a"])({url:"/business/article/chapterList",method:"get",params:t})}function l(t){return Object(o["a"])({url:"/business/article/allChapterInfoList",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/business/article/postedList",method:"get",params:t})}function s(t){return Object(o["a"])({url:"/business/article/"+t,method:"get"})}function c(t){return Object(o["a"])({url:"/business/article",method:"post",data:t})}function u(t){return Object(o["a"])({url:"/business/article",method:"put",data:t})}function d(t){return Object(o["a"])({url:"/business/article/"+t,method:"delete"})}},aece:function(t,e,i){"use strict";i.d(e,"d",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return l})),i.d(e,"e",(function(){return r})),i.d(e,"b",(function(){return s}));var o=i("b775");function a(t){return Object(o["a"])({url:"/business/tag/list",method:"get",params:t})}function n(t){return Object(o["a"])({url:"/business/tag/"+t,method:"get"})}function l(t){return Object(o["a"])({url:"/business/tag",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/business/tag",method:"put",data:t})}function s(t){return Object(o["a"])({url:"/business/tag/"+t,method:"delete"})}},bd44:function(t,e,i){"use strict";i("39eb")},e07a:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"content"},[i("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),1===t.form.chapter?i("el-form-item",{attrs:{label:"合集",prop:"categoryPath"}},[i("el-cascader",{staticStyle:{width:"100%"},attrs:{options:t.metaCategoryList,placeholder:"请选择合集",props:{checkStrictly:!0},clearable:""},model:{value:t.metaCategoryPath,callback:function(e){t.metaCategoryPath=e},expression:"metaCategoryPath"}})],1):t._e()],1),i("el-col",{attrs:{xs:24,sm:12}},[1===t.form.chapter?i("el-form-item",{attrs:{label:"分级",prop:"rating"}},[i("el-radio-group",{model:{value:t.form.rating,callback:function(e){t.$set(t.form,"rating",e)},expression:"form.rating"}},[i("el-radio",{attrs:{label:"0"}},[t._v("清水")]),i("el-radio",{attrs:{label:"1"}},[t._v("18+")]),i("el-radio",{attrs:{label:"2"}},[t._v("无分级")])],1)],1):t._e(),1===t.form.chapter?i("el-form-item",{attrs:{label:"连载状态",prop:"status"}},[i("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[i("el-radio",{attrs:{label:"0"}},[t._v("已完结")]),i("el-radio",{attrs:{label:"1"}},[t._v("连载中")])],1)],1):t._e()],1),i("el-col",{attrs:{xs:24,sm:12}},[i("el-form-item",{attrs:{label:"评论区",prop:"isComment"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.form.isComment,callback:function(e){t.$set(t.form,"isComment",e)},expression:"form.isComment"}})],1)],1),i("el-col",{attrs:{span:24}},[1===t.form.chapter?i("el-form-item",{attrs:{label:"标签",prop:"tag"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择标签"},on:{"remove-tag":t.removeTag},model:{value:t.tagList,callback:function(e){t.tagList=e},expression:"tagList"}},t._l(t.options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1),i("span",{staticStyle:{"font-size":"0.8em"}},[t._v("Tips：如果类型是同人，标签最好包括这些内容：Fandom、CP、AU、角色等等，上面选过的内容就不用加了")])],1):t._e(),1===t.form.chapter?i("el-form-item",{attrs:{label:"概述",prop:"summary"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1):t._e(),i("el-form-item",{attrs:{label:"章节",prop:"chapter"}},[i("el-input-number",{model:{value:t.form.chapter,callback:function(e){t.$set(t.form,"chapter",e)},expression:"form.chapter"}})],1),i("el-form-item",{attrs:{label:"笔记",prop:"note"}},[i("el-switch",{model:{value:t.addNote,callback:function(e){t.addNote=e},expression:"addNote"}}),t.addNote?i("el-radio-group",{staticStyle:{"margin-left":"30px"},model:{value:t.form.notePosition,callback:function(e){t.$set(t.form,"notePosition",e)},expression:"form.notePosition"}},[i("el-radio",{attrs:{label:"0"}},[t._v("放在开头")]),i("el-radio",{attrs:{label:"1"}},[t._v("放在结尾")])],1):t._e(),t.addNote?i("el-input",{attrs:{type:"textarea"},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}}):t._e()],1)],1)],1)],1),i("tiptap",{attrs:{value:t.form.content,editable:!0},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),i("div",{staticClass:"btn-list"},[i("el-button",{attrs:{type:"primary",round:""},on:{click:function(e){return t.handleSubmit("0")}}},[t._v("发布")]),i("el-button",{attrs:{type:"info",round:""},on:{click:function(e){return t.handleSubmit("1")}}},[t._v("草稿")]),i("el-button",{attrs:{round:""},on:{click:t.goBack}},[t._v("返回")])],1)])},a=[],n=(i("d81d"),i("a9e3"),i("14d9"),i("b0c0"),i("a15b"),i("99af"),i("6df5")),l=i("8bc5"),r=i("a1fc"),s=i("aece"),c=i("25eb"),u={name:"articleInfo",components:{Tiptap:n["a"]},data:function(){return{form:{},rules:{title:[{required:!0,message:"文章标题不能为空",trigger:"blur"}],rating:[{required:!0,message:"请选择文章的分级",trigger:"change"}]},type:"",tag:[],options:[],metaCategoryList:[],metaCategoryPath:[],addNote:!1,content:"",tagList:{},articleIdList:[]}},computed:{key:function(){return this.$route.query.key},id:function(){return this.$route.query.id}},created:function(){this.getCategory(),"edit"===this.key?this.getArticleInfo():"add"===this.key?(this.reset(),this.getTag(),this.form.chapter=1):"addChapter"===this.key&&this.handleAddChapter()},methods:{goBack:function(){this.$router.back()},getArticleInfo:function(){var t=this;Object(r["d"])(this.id).then((function(e){t.form=e.data,t.metaCategoryPath=e.data.categoryPath.split("/").map(Number),t.addNote=!!t.form.note;var i={articleId:t.id};Object(c["b"])(i).then((function(e){t.articleIdList=e.rows,t.getTag()}))}))},handleAddChapter:function(){var t=this;Object(r["d"])(this.id).then((function(e){t.form={id:null,remark:null,delFlag:null,title:null,summary:null,note:null,content:null,status:null,isComment:"0",isTop:null,categoryId:null,categoryPath:"",notePosition:null,chapter:null,parentArticle:t.id},t.metaCategoryPath=e.data.categoryPath.split("/").map(Number);var i={parentArticle:t.id};Object(r["b"])(i).then((function(e){t.form.chapter=e.rows.length+1}))}))},getTag:function(){var t=this;Object(s["d"])().then((function(e){t.options=e.rows.map((function(t){return{label:t.tagName,value:t.id}})),t.showTagName()}))},showTagName:function(){for(var t=0;t<this.articleIdList.length;t++)for(var e=0;e<this.options.length;e++)if(this.options[e].value===this.articleIdList[t].tagId){this.tagList.push(this.options[e].label);break}},removeTag:function(t){for(var e=0;e<this.articleIdList.length;e++)this.articleIdList[e].tagName===t&&Object(c["a"])(this.articleIdList[e].id).then((function(t){}))},getCategory:function(){var t=this;Object(l["d"])().then((function(e){t.metaCategoryList=e.rows.map((function(e){return{value:e.id,label:e.name,children:e.children?t.getChildren(e.children):null}}))}))},getChildren:function(t){var e=this;return t.map((function(t){return{value:t.id,label:t.name,children:t.children?e.getChildren(t.children):null}}))},reset:function(){this.form={id:null,remark:null,delFlag:null,title:null,summary:null,note:null,content:null,status:"1",isComment:"1",isTop:null,categoryId:null,categoryPath:"",notePosition:null,chapter:null}},handleSubmit:function(t){var e=this;this.$refs["form"].validate((function(i){if(i){e.form.delFlag=t,e.tagList.length>0&&(e.form.tag=e.tagList.join(","));var o=new Date,a="".concat(o.getFullYear(),"-").concat(o.getMonth()+1,"-").concat(o.getDate()," ").concat(o.getHours(),":").concat(o.getMinutes(),":").concat(o.getSeconds());e.metaCategoryPath?(e.form.categoryPath=e.metaCategoryPath.join("/"),e.form.categoryId=e.metaCategoryPath[e.metaCategoryPath.length-1],"add"===e.key||"addChapter"===e.key?(e.form.click=0,e.form.kudos=0,e.form.createTime=a,e.form.updateTime=a,Object(r["a"])(e.form).then((function(t){200===t.code&&(e.$modal.msgSuccess("新增成功"),e.goBack())}))):"edit"===e.key&&(e.form.categoryPath=e.metaCategoryPath.join("/"),Object(r["h"])(e.form).then((function(t){200===t.code&&(e.$modal.msgSuccess("修改成功"),e.goBack())})))):e.$modal.msgError("请选择合集")}}))}}},d=u,f=(i("08f1"),i("2877")),p=Object(f["a"])(d,o,a,!1,null,"0a1402c2",null);e["default"]=p.exports}}]);